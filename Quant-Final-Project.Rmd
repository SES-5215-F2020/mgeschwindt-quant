---
title: "An Analysis of Women's Commute Times in New York City"
author: "Mary Geschwindt"
date: "10/16/2020"
output:
  html_document:
    theme: paper
    toc: yes
    toc_depth: 3
    toc_float: yes
---

```{r setup, include=FALSE, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load libraries, message=FALSE, echo=FALSE}
library(tidycensus)
library(tidyverse)
library(ggplot2)
library(lemon)
library(scales)
library(knitr)
library(jtools)
library(interactions)
library(huxtable)
```

```{r load data, message=FALSE, echo=FALSE}
women_data <- read.csv("women_nyctransport2018.csv")

attach(women_data)
```

```{r recode, message=FALSE, results='hide', warning=FALSE, echo=FALSE}
women_data <- read_csv("women_nyctransport2018.csv") %>%
  mutate(JWTR_label = case_when(
    JWTR_label=="Bicycle"~"Bicycle",
    JWTR_label=="Bus or trolley bus"~"Bus",
    JWTR_label=="Car, truck, or van"~"1Car",
    JWTR_label=="Ferryboat"~"Ferry",
    JWTR_label=="Other method"~"Other",
    JWTR_label=="Railroad"~"Train",
    JWTR_label=="Subway or elevated"~"Subway",
    JWTR_label=="Taxicab"~"Taxi",
    JWTR_label=="Walked"~"Walked")) %>%
  mutate(DPHY_label = case_when(
    DPHY_label=="Yes"~"Physically Disabled",
    DPHY_label=="No"~"Not Physically Disabled"))
```


```{r set lemon print functions, message=FALSE, results='hide', echo=FALSE}
knit_print.data.frame <- lemon_print
```

## Research Question and Hypothesis

For this project, I was curious about women's commutes in New York City. I wanted to study what types of modes of transportation are women most likely to use, and whether having a physical disability would further define what types of modes of transportation are used in addition to increased or decreased travel times. My research question is:

**Is a woman's travel time to work in New York City impacted by her mode of transportation and whether she has a physical disability?**

My hypothesis is that women who live and commute to work in New York City may have varied travel times to work, and that these travel times are related to their means of transportation, their age, their income, and whether or not they have a physical disability. I was curious about race as a variable for several of the steps in the study, so I included that variable in my dataset as well. I hypothesize that these variables may have positive or negative impacts on women's lives depending on how they might shorten or lengthen their commute times. Because my research question can only answer a yes or no question, determining whether commute times reflect a positive or negative impact on a woman's life would have to be further studied using more quantitative and qualitative data analyses.

This research question is important because it is a means of understanding how equitable the transportation infrastructures are in New York City. There are many ways to define what equitable means; one can look at equity in terms of gender, race, age, physical ability, income, and other variables. This assignment cannot, and does not seek to, determine whether or not New York's transportation infrastructures serve all people in the City equally. This project does look at one specific population to try to determine whether some of the variables have a relationship with respect to time, and considering longer or shorter commute times as unequal experiences which could be further studied in order to determine whether they constitute a real inequity.

## Dataset

### Population

The population is women in who live in New York City who have a commute to work. The data is taken at the person-level, and there are 327 observations in the dataset. This means that there are 327 women who are included in this analysis. All New York City Public Use Microdata Areas (PUMAs) were used to define the geographic boundaries for the sample of women counted.

### Variables

Using the US Census 1-year American Community Survey from 2018 as my data source, I selected the following variables to test my hypothesis:

**Means of transportation to work, or JWTR_label (categorical variable):**
I selected means of transportation to work because this is a variable which may be related to commute times, depending on which mode of transportation is used. This variable can also be impacted by other variables, such as income, which may influence which means of transportation a woman in this sample is able to afford to take daily.

**Age, or AGEP (continuous variable):**
Age was selected because a woman's age may be related to her income, perhaps impacting what means of transportation she can afford. It may also be related to her physical abilities in taking certain kinds of transportation.

**Travel time to work, or JWMNP (continuous variable):**
Travel time to work was selected because there may be relationships between all other variables and how fast a woman can get to work given the other selected variables. I selected travel time under the assumption that it could be one of the indicators for how equitable a transportation system is.

**Ambulatory difficulty, or DPHY_label (categorical variable):**
Ambulatory difficulty, or physical disability, was selected because it may be related to a woman's inability to take certain types of transportation modes, which in turn could impact travel times.

**Race, or RAC1P_label (categorical variable):**
Race was selected because I was curious if there was a relationship between access to a mode of transportation and race based on a woman's physical location - the reason for selecting this variable presents a slightly different hypothesis, which is that race may be related to where a woman lives. A woman's home location may then be related to what transportation infrastructures she has access to in her home neighborhood. Where a woman lives and what she has access to might be related to her travel time to work. This variable is interesting to look at in terms of correlation, but it requires further study for a more specific and slightly different hypothesis related to equity and transportation.

**Income, or PINCP (continuous variable):**
Income was selected because it may be related to what means of transportation a women might be able to afford in New York City; for example, the costs associated with owning and maintaining a car to drive to work in NYC are much higher than owning a bicycle which could be ridden to work instead.

Table 1 below presents the first 6 observations of the 327 in this dataset:

```{r table 1, message=FALSE, caption="Table 1", render=lemon_print, echo=FALSE}
head(women_data)
```


## Methods

### Distributions & Proportions

Once the population and variables were determined and the dataset created, my first method was to understand what the distributions and proportions of this sample are. To do this, I took a different approach depending on whether the variables were continuous or categorical. For continuous variables, I calculated the summary statistics, including the sample mean, sample standard deviation, the 95-percent confidence interval for the population mean, and the interquartile range. The results for the continuous variables, which include age, income, and travel time to work, are as follows:

```{r summary statistics calculation, message=FALSE, results='hide', echo=FALSE}
age_summary <- summary(women_data$AGEP)
age_sd <- sd(AGEP, na.rm = TRUE)
age_mean_int <- t.test(AGEP)
time_summary <- summary(women_data$JWMNP)
time_sd <- sd(JWMNP, na.rm = TRUE)
time_mean_int <- t.test(JWMNP)
income_summary <- summary(women_data$PINCP)
income_sd <- sd(PINCP, na.rm = TRUE)
income_mean_int <- t.test(PINCP)
```

```{r summary statistics table, message=FALSE, echo=FALSE}
summary_table <- tibble(
  Statistic = c("Sample Mean",
                "Median",
                "Standard deviation",
                "Interquartile range",
                "Population mean (95% confidence)"),
  'Age (years)' = c(prettyNum(age_summary["Mean"], digits = 3),
                    age_summary["Median"],
                    prettyNum(age_sd, digits = 3),
                    paste(age_summary["1st Qu."], "to",
                          age_summary["3rd Qu."]),
                    paste(prettyNum(age_mean_int$conf.int[1],
                                    digits = 3), "to",
                          prettyNum(age_mean_int$conf.int[2],
                                    digits = 3))),
  'Travel Time to Work (minutes)' = c(paste(prettyNum(time_summary["Mean"], digits = 3)),
                                            paste(prettyNum(time_summary["Median"], digits = 3)),
                                            paste(prettyNum(time_sd, digits = 3)),
                                            paste(prettyNum(time_summary["1st Qu."], digits = 3), "to",
                                                  prettyNum(time_summary["3rd Qu."], digits = 3)),
                                            paste(prettyNum(time_mean_int$conf.int[1], digits = 3), "to",
                                                  prettyNum(time_mean_int$conf.int[2], digits = 3))),
  'Income (dollars)' = c(paste(prettyNum(income_summary["Mean"], digits = 7)),
                         paste(prettyNum(income_summary["Mean"], digits = 7)),
                         paste(prettyNum(income_sd, digits = 7)),
                         paste(prettyNum(income_summary["1st Qu."], digits = 7), "to",
                               prettyNum(income_summary["3rd Qu."], digits = 7)),
                         paste(prettyNum(income_mean_int$conf.int[1], digits = 7), "to",
                               prettyNum(income_mean_int$conf.int[2], digits = 7))))
  knitr::kable(summary_table,
               caption = "Characteristics for Women in New York City")
```

The distribution of each of these continuous variables may be visualized through Figures 1, 2, and 3:

```{r figure 1, message=FALSE, results='hide', echo=FALSE}
ggplot(women_data,
       aes(x=AGEP)) +
  geom_histogram(color = "gray", binwidth = 2) +
  scale_x_continuous(name = "Age (years)") +
  scale_y_continuous(name = "Number of People in Sample") +
  stat_bin(binwidth = 1) +
  labs(title = "Figure 1: Distribution of Age Across Sample Population")
  theme_minimal()
```

```{r figure 2, message=FALSE, results='hide', echo=FALSE}
ggplot(women_data,
       aes(x=JWMNP)) +
  geom_histogram(color = "gray", binwidth = 10) +
  scale_x_continuous(name = "Travel Time to Work (minutes)") +
  scale_y_continuous(name = "Number of People in Sample") +
  labs(title = "Figure 2: Distribution of Travel Time Across Sample Population")
  theme_minimal()
```

```{r figure 3, message=FALSE, results='hide', warning=FALSE, echo=FALSE}
ggplot(women_data,
       aes(x=PINCP)) +
  geom_histogram() +
  scale_x_continuous(name = "Income (dollars)",
                     label = comma,
                     limits = c(0, 700000)) +
  scale_y_continuous("Number of People in Sample") +
  labs(title = "Figure 3: Distribution of Income Across Sample Population")
  theme_minimal()
```

For categorical variables, I calculated each proportion and confidence interval using a T-Test. Tables 2, 3, and 4 present the proportions and confidence intervals for means of transportation to work, physical disability, and race, respectively.

```{r table 2, message=FALSE, echo=FALSE}
transport <- unique(JWTR_label)

car <- t.test(JWTR_label == transport[1])
subway <- t.test(JWTR_label == transport[2])
walked <- t.test(JWTR_label == transport[3])
bus <- t.test(JWTR_label == transport[4])
other <- t.test(JWTR_label == transport[5])
bicycle <- t.test(JWTR_label == transport[6])
railroad <- t.test(JWTR_label == transport[7])
taxi <- t.test(JWTR_label == transport[8])
ferry <- t.test(JWTR_label == transport[9])
shares <- tibble()

transport_shares <- tibble("Transport" = c("Car, truck, or van",
                                             "Subway or elevated",
                                             "Walked",
                                             "Bus or trolley bus",
                                             "Other method",
                                             "Bicycle",
                                             "Railroad",
                                             "Taxicab",
                                             "Ferryboat"),
                           "Sample Proportion" = c(paste(prettyNum(car$estimate*100, digits = 3), "%"),
                                                      paste(prettyNum(subway$estimate*100, digits = 3), "%"),
                                                      paste(prettyNum(walked$estimate*100, digits = 3), "%"),
                                                      paste(prettyNum(bus$estimate*100, digits = 3), "%"),
                                                      paste(prettyNum(other$estimate*100,digits = 3), "%"),
                                                      paste(prettyNum(bicycle$estimate*100,digits = 3), "%"),
                                                      paste(prettyNum(railroad$estimate*100,digits = 3), "%"),
                                                      paste(prettyNum(taxi$estimate*100,digits = 3), "%"),
                                                      paste(prettyNum(ferry$estimate*100,digits = 3), "%")),
                           "95-percent Confidence Interval" = c(paste(prettyNum(car$conf.int[1]*100, digits = 3), "% to",
                                                                   prettyNum(car$conf.int[2]*100, digits = 3), "%", sep = ""),
                                                                paste(prettyNum(subway$conf.int[1]*100, digits = 3), "% to",
                                                                   prettyNum(subway$conf.int[2]*100, digits = 3), "%", sep = ""),
                                                                paste(prettyNum(walked$conf.int[1]*100, digits = 3), "% to",
                                                                   prettyNum(walked$conf.int[2]*100, digits = 3), "%", sep = ""),
                                                                paste(prettyNum(bus$conf.int[1]*100, digits = 3), "% to",
                                                                   prettyNum(bus$conf.int[2]*100, digits = 3), "%", sep = ""),
                                                                paste(prettyNum(other$conf.int[1]*100, digits = 3), "% to",
                                                                   prettyNum(other$conf.int[2]*100, digits = 3), "%", sep = ""),
                                                                paste(prettyNum(bicycle$conf.int[1]*100, digits = 3), "% to",
                                                                   prettyNum(bicycle$conf.int[2]*100, digits = 3), "%", sep = ""),
                                                                paste(prettyNum(railroad$conf.int[1]*100, digits = 3), "% to",
                                                                   prettyNum(railroad$conf.int[2]*100, digits = 3), "%", sep = ""),
                                                                paste(prettyNum(taxi$conf.int[1]*100, digits = 3), "% to",
                                                                   prettyNum(taxi$conf.int[2]*100, digits = 3), "%", sep = ""),
                                                               paste(prettyNum(ferry$conf.int[1]*100, digits = 3), "% to",
                                                                   prettyNum(ferry$conf.int[2]*100, digits = 3), "%", sep = "")))

knitr::kable(transport_shares, caption = "Table 2 (New York City Census Tracts)")
```

```{r disability status, message=FALSE, results='hide', message=FALSE, echo=FALSE}
disability_status <- unique(women_data$DPHY_label)
disability_status
```

```{r set up disability ttest, message=FALSE, results='hide', message=FALSE, echo=FALSE}
not_disabled <- t.test(DPHY_label == disability_status[1])
disabled <- t.test(DPHY_label == disability_status[2])
```


```{r table 3, message=FALSE, echo=FALSE}
disability_shares <- tibble("Physical Disability" = c("Not Physically Disabled",
                                                      "Physically Disabled"),
                            "Sample Proportion" = c(paste(prettyNum(not_disabled$estimate*100, digits = 3), "%"),
                                                    paste(prettyNum(disabled$estimate*100, digits = 3), "%")),
                            "95-Percent Confidence Interval" = c(paste(prettyNum(not_disabled$conf.int[1]*100, digits = 3), "% to",
                                                                       prettyNum(not_disabled$conf.int[2]*100, digits = 3), "%", sep = ""),
                                                                 paste(prettyNum(disabled$conf.int[1]*100, digits = 3), "% to",
                                                                       prettyNum(disabled$conf.int[2]*100, digits = 3), "%", sep = "")))

knitr::kable(disability_shares, caption = "Table 3 (New York City Census Tracts)")
```


```{r table 4, message=FALSE, echo=FALSE}
race <- unique(women_data$RAC1P_label)

white <- t.test(RAC1P_label == race[1])
black <- t.test(RAC1P_label == race[2])
other_alone <- t.test(RAC1P_label == race[3])
asian <- t.test(RAC1P_label == race[4])
two_more <- t.test(RAC1P_label == race[5])

race_shares <- tibble("Race" = c("White Alone",
                                 "Black or African American Alone",
                                 "Some Other Race Alone",
                                 "Asian Alone",
                                 "Two or More Races"),
                           "Sample Proportion" = c(paste(prettyNum(white$estimate*100, digits = 3), "%"),
                                                   paste(prettyNum(black$estimate*100, digits = 3), "%"),
                                                   paste(prettyNum(other_alone$estimate*100, digits = 3), "%"),
                                                   paste(prettyNum(asian$estimate*100, digits = 3), "%"),
                                                   paste(prettyNum(two_more$estimate*100, digits = 3), "%")),
                           "95-percent Confidence Interval" = c(paste(prettyNum(white$conf.int[1]*100, digits = 3), "% to",
                                                                      prettyNum(white$conf.int[2]*100, digits = 3), "%", sep = ""),
                                                                paste(prettyNum(black$conf.int[1]*100, digits = 3), "% to",
                                                                      prettyNum(black$conf.int[2]*100, digits = 3), "%", sep = ""),
                                                                paste(prettyNum(other_alone$conf.int[1]*100, digits = 3), "% to",
                                                                      prettyNum(other_alone$conf.int[2]*100, digits = 3), "%", sep = ""),
                                                                paste(prettyNum(asian$conf.int[1]*100, digits = 3), "% to",
                                                                      prettyNum(asian$conf.int[2]*100, digits = 3), "%", sep = ""),
                                                                paste(prettyNum(two_more$conf.int[1]*100, digits = 3), "% to",
                                                                      prettyNum(two_more$conf.int[2]*100, digits = 3), "%", sep = "")))

knitr::kable(race_shares, caption = "Table 4 (New York City Census Tracts)")
```

### Relationships

Once distributions and proportions were determined for each variable, I tested the relationship between every possible pair of variables to determine whether there was correlation. For relationships between continuous variables, I used a Pearson's correlation test to determine the strength and the significance of the relationship. For relationships between a continuous variable and a binary categorical variable, I used a two-sample t-test to determine the strength and the significance of the relationship. For a relationship between a continuous variable and a categorical variable with more then two categories, I used an ANOVA test to determine the significance of the relationship. Finally, I used a Chi-square test for testing each relationship between categorical variables to determined the significance of the relationship.

First I will describe the results from the Pearson's correlation tests. Any test which returned a p-value less than 0.05 indicates that the relationship is significant. A correlation value is returned between -1 and 1, with the closer a value is to either -1 or 1 indicating a stronger correlation, and the negative or positive value indicating whether the correlation is negative or positive. With a p-value of 0.004, age and travel time to work were found to have a significant relationship (Figure 4). The correlation is weak but positive. Income and age were also found to have a significant relationship with a p-value of 0.007; the correlation is again weak but positive (Figure 5). Income and travel time to work returned a p-value of 0.86, meaning it is not a significant relationship.

```{r figure 4, message=FALSE, results='hide', echo=FALSE}
correlation1 <- cor.test(women_data$AGEP, women_data$JWMNP)

ggplot(women_data, aes(x = AGEP, y = JWMNP)) +
  geom_point(size = 0.5, alpha = 0.25, position = "jitter") +
  geom_smooth() +
  theme_bw() +
  scale_x_continuous(name = "Age (years)") +
  scale_y_continuous(name = "Travel Time to Work (minutes)") +
  annotate(geom = "text", x = 21, y = 155,
           label = paste("Correlation (95-percent confidence):",
                         prettyNum(correlation1$conf.int[1], digits = 3),
                                   "to",
                                   prettyNum(correlation1$conf.int[2], digits = 3)),
                         hjust = 0) +
  labs(title = "Figure 4")
```

The correlation between travel time and age indicates that women under 30 and women over 60 have slightly shorter commute times than women who fall between the ages of 30 and 60. On average, there is a small decrease in commute times for women in their mid-forties. Women just around 30 and 60 years old can be expected to have the longest commute times on average.

```{r figure 5, message=FALSE, results='hide', echo=FALSE}
correlation2 <- cor.test(women_data$PINCP, women_data$AGEP)

ggplot(women_data, aes(x = PINCP, y = AGEP)) +
  geom_point(size = 0.5, alpha = 0.25, position = "jitter") +
  geom_smooth() +
  theme_bw() +
  scale_x_continuous(name = "Income (dollars)") +
  scale_y_continuous(name = "Age (years)") +
  annotate(geom = "text", x = 16, y = 75,
           label = paste("Correlation (95-percent confidence):",
                         prettyNum(correlation2$conf.int[1], digits = 6),
                                   "to",
                                   prettyNum(correlation2$conf.int[2], digits = 6)),
                         hjust = 0) +
  labs(title = "Figure 5")
```

The correlation between age and income indicates that the older a woman is, the more likely she is to have a higher income. There is an exception for women around the age of 42 in which income levels drop slightly compared to women around the ages of 43; this income then sees a fairly constant increase as age increases. This relationship between older women having higher incomes may demonstrate, with further study, that there is a relationship between age and means of transportation to work, given that the higher income which may come with higher age may indicate which means of transportation to work a woman is more likely to be able to afford and have access to.

For the two-sample t-tests, age and physical disability, travel time to work and physical disability, and income and physical disability were all found to not be significant due to having high p-values.

For the ANOVA tests, age and means of transportation were found to have a significant relationship (Figure 6), while both travel time and means of transportation and income and means of transportation were found to have a very significant relationship each. Travel time and race, and income and race, also have significant relationships due to having p-values less than 0.05.

```{r figure 6, message=FALSE, results='hide', echo=FALSE}
anova1 <- aov(AGEP ~ JWTR_label, data = women_data)

differences1 <- TukeyHSD(anova1)

ggplot(women_data, aes(x = JWTR_label, y = AGEP)) +
  geom_boxplot() +
  theme_bw() +
  scale_x_discrete(name = "Means of Transportation to Work",
                  labels = c("Bicycle",
                                  "Bus or\n trolley bus",
                                  "Car\n truck\n or van",
                                  "Ferryboat",
                                  "Other", 
                                  "Railroad",
                                  "Subway\n or elevated",
                                  "Taxicab",
                                  "Walked")) +
  scale_y_continuous(name = "Age (years)") +
  labs(title = "Figure 6")
```

The box plot in Figure 6 presents the relationship between age and means of transportation to work. The visual further demonstrates that some means of transportation to work may be more significant than others. This significance will be tested later in this report in a linear regression model.

Results for the Chi-square tests indicate that means of transportation to work and physical disability is a significant relationship. The same result was found for means of transportation to work and race. Finally, physical disability and race was found not to have a significant relationship with a p-value of 0.09.

### Linear Regression Analysis

After determining the significance and strength of every possible variable relationship, I conducted a linear regression. I used the following variables in the linear regression model:

1. *Means of Transportation to Work* (JWTR_Label), because daily patterns of rush hour traffic delays and systems delays for different modes of transportation may influence the time spent traveling to work. All means are compared to a car.
2. *Income* (PINCP), because a person's income may determine what means of transportation they can afford to take on a daily basis.
3. *Ambulatory difficulty* (DPHY_label), because a person's physical disability may determine what means of transportation they are physically capable of taking, in addition to how much time they may need to navigate the city with a physical disability. The reference variable is not physically disabled.
4. *Age* (AGEP), because my sample population includes individuals under the legal driving age which influences available means of transportation for some of my sample population.

This initial linear regression model calculates that the R-squared value is about 0.29. This means that 29% of the variation in a woman's commute time in NYC can be predicted given her means of transportation, her income, whether she has a physical disability, and her age.

This regression model also reveals that certain variables are more significant than others. For means of transportation to work, the bus, subway, train, and walking are indicated as significant, because their p-values are less than 0.05. None of the other variables are significant, according to this model.

### Interactions & Transformations

Finally, I tested several variations of my initial linear regression model (Model 1) to determine which model is the preferred model. I completed a log transformation of the variable for income for the first model variation (Model 2), because it is possible that it is percentage changes of income which may make a difference for every additional minute for which a woman in NYC commutes to work, rather than discrete dollar amounts. I also attempted to convert age into a categorical variable (Model 3) in order to distinguish between an assumption I have that younger women may have children and therefore longer commute times which consist of dropping children off at school or daycare. Finally, I created two versions of regression models which use an interaction term. One model uses an interaction term for physical disability and age (Model 4), because I suspect that an older woman may be more likely to have a physical disability. The other model uses an interaction term for means of transportation to work and age (Model 5), because I suspect that age may have an affect on what means of transportation a woman is more able to take.

Table 5 presents a comparison between all models.

```{r table 5, message=FALSE, echo=FALSE}
model1 <- lm(JWMNP ~ JWTR_label + PINCP + DPHY_label + AGEP,
            data = women_data)
model2 <- lm(JWMNP ~ JWTR_label + log(PINCP) + DPHY_label + AGEP,
            data = women_data)

women_data <- women_data %>%
  mutate(age_group = case_when(AGEP <= 49 ~ "Younger",
                               AGEP >= 50 ~ "Older"))

model3 <- lm(JWMNP ~ JWTR_label + log(PINCP) + DPHY_label + age_group,
            data = women_data)

model4 <- lm(JWMNP ~ JWTR_label + log(PINCP) + DPHY_label + AGEP + DPHY_label:AGEP,
             data = women_data)

model5 <- lm(JWMNP ~ JWTR_label:AGEP + log(PINCP) + DPHY_label + AGEP + DPHY_label,
             data = women_data)

coeff_names <- c("Means of Transportation\nto work(compared to car)" = "JWTR_labelBicycle",
                 "Means of Transportation\nto work(compared to car)" = "JWTR_labelBus",
                 "Means of Transportation\nto work(compared to car)" = "JWTR_labelFerry",
                 "Means of Transportation\nto work(compared to car)" = "JWTR_labelOther",
                 "Means of Transportation\nto work(compared to car)" = "JWTR_labelSubway",
                 "Means of Transportation\nto work(compared to car)" = "JWTR_labelTaxi",
                 "Means of Transportation\nto work(compared to car)" = "JWTR_labelTrain",
                 "Means of Transportation\nto work(compared to car)" = "JWTR_labelWalked",
                 "Income (dollars)" = "PINCP",
                 "Income\n(log-transformed)" = "log(PINCP)",
                 "Age (years)" = "AGEP",
                 "Age (Under 50)" = "age_groupYounger",
                 "Physical Disability\n(compared to not disabled)" = "DPHY_labelPhysically Disabled",
                 "Interaction: Disability and Age" = "DPHY_labelPhysically Disabled:AGEP",
                 "Interaction: Means of Transportation\nto Work and Age" = "JWTR_labelBicycle:AGEP",
                 "Interaction: Means of Transportation\nto Work and Age" = "JWTR_labelBus:AGEP",
                 "Interaction: Means of Transportation\nto Work and Age" = "JWTR_labelFerry:AGEP",
                 "Interaction: Means of Transportation\nto Work and Age" = "JWTR_labelOther:AGEP",
                 "Interaction: Means of Transportation\nto Work and Age" = "JWTR_labelSubway:AGEP",
                 "Interaction: Means of Transportation\nto Work and Age" = "JWTR_labelTaxi:AGEP",
                 "Interaction: Means of Transportation\nto Work and Age" = "JWTR_labelTrain:AGEP",
                 "Interaction: Means of Transportation\nto Work and Age" = "JWTR_labelWalked:AGEP")


export_summs(model1, model2, model3, model4, model5,
             error_format = "(p = {p.value})",
             error_pos = "same",
             coefs = coeff_names)
```

With R-squared values close to 0.29, Models 1, 2, 3, and 4 are all higher than Model 5. The model with the highest R-squared value is Model 3, which has a value slightly higher than the other models at R-squared = 0.2919.

## Results

Table 5 presents a comparison of each regression model tested in order to answer my research question. The table presents the R-squared values for all models; the higher the R-squared value, the better the model fit. Of each of the regression models tested, Model 3, which includes a log transformation of the income variable as well as a conversion of age from a continuous to a categorical variable, is the preferred model because it has the highest R-squared value (0.2919). Figure 7 visualizes each model, presenting again that Model 3 has the best fit.

```{r figure 7, message=FALSE, results='hide', echo=FALSE}
ModelFit <- tibble(model = c(1, 2, 3, 4, 5),
                   R_square = c(summary(model1)$adj.r.squared,
                                summary(model2)$adj.r.squared,
                                summary(model3)$adj.r.squared,
                                summary(model4)$adj.r.squared,
                                summary(model5)$adj.r.squared))

ggplot(ModelFit, aes(x = model, y = R_square)) +
  geom_line() +
  scale_x_continuous(name = "",
                     breaks = breaks <- seq(1, 5, by = 1),
                     labels = paste("Model", breaks)) +
  scale_y_continuous(name = "Adjusted R-squared value") +
  labs(title = "Figure 7") +
  theme_minimal()
```

An interpretation of Model 3 having the best fit could be that grouping women by age may reveal that younger women who have children under the age of 18 are more likely to have longer commutes because of "trip-chaining", or grouping several stops into a single, longer trip. A further study would need to be tested which include variables such as children in a household under the age of 18 in order to explore a relationship between younger women, presence of children, and longer commute times.

The regression model for Model 3 is presented below:

```{r model 3 regression table, message=FALSE, echo=FALSE}
women_data <- women_data %>%
  mutate(age_group = case_when(AGEP <= 49 ~ "Younger",
                               AGEP >= 50 ~ "Older"))

model3 <- lm(JWMNP ~ JWTR_label + log(PINCP) + DPHY_label + age_group,
            data = women_data)

summary(model3)
```

The significant variables in Model 3 are bus, subway, train, and walked for the means of transportation variables. The means of transportation variables are compared to a car as the reference variable. Younger, for age group, is very close to being significant in this regression model. In this case, "younger" is compared to the reference variable "older".

Figure 8 presents the 95-percent confidence intervals for the Model 3 coefficients.

```{r figure 8, message=FALSE, results='hide', echo=FALSE}
coeff_desc <- c("Bicycle\n(compared to car)" = "JWTR_labelBicycle",
                 "Bus\n(compared to car)" = "JWTR_labelBus",
                 "Ferry\n(compared to car)" = "JWTR_labelFerry",
                 "Other Means\n(compared to car)" = "JWTR_labelOther",
                 "Subway\n(compared to car)" = "JWTR_labelSubway",
                 "Taxi\n(compared to car)" = "JWTR_labelTaxi",
                 "Train\n(compared to car)" = "JWTR_labelTrain",
                 "Walked\n(compared to car)" = "JWTR_labelWalked",
                 "Income\n(log-transformed)" = "log(PINCP)",
                 "Age (Under 50)" = "age_groupYounger",
                 "Physical Disability\n(compared to not disabled)" = "DPHY_labelPhysically Disabled")

plot_coefs(model3,
           coefs = coeff_desc,
           plot.distributions = TRUE,
           rescale.distributes = TRUE) +
  scale_x_continuous(name = "Effect on predicted travel time to work (minutes)") +
  labs(title = "Figure 8")
```

Several of the coefficients cross the line for 0, meaning that one cannot be 95-percent confident that these variables are significant because they may include a correlation value of 0.

Figure 9 presents a graph of the relationship between income (which has a log transformation) and commute time for women who are older verses women who are younger. For the purposes of this model, "younger" means women under the age of 50 years, while "older" includes all women 50 years of age and older. Figure 9 reveals that there is a difference between older and younger women's commute times, but that it is actually women in the older category who tend to have longer commute times. This is the opposite of my initial assumption, which was that younger women (who may have children) would be expected to have longer commute times on average.

```{r figure 9, message=FALSE, results='hide', warning=FALSE, echo=FALSE}
interact_plot(model3, pred = PINCP, modx = age_group, interval = TRUE) +
  scale_x_continuous(name = "Annual Income (thousands)",
                     limits = c(0, 700000),
                     breaks = breaks <- seq(0, 700000, by = 70000),
                     labels = paste("$",
                                    prettyNum(breaks/1000, big.mark = "'"),
                                    sep = "")) +
  scale_y_continuous(name = "Travel Time to Work (minutes)",
                     breaks = seq(0, 150, by = 5)) +
  scale_color_discrete(name = "") +
  scale_linetype_discrete(name = "") +
  scale_fill_discrete(name = "") +
  labs(title = "Figure 9")
```

## Discussion & Limitations

To reiterate my research question, I am seeking to understand if there is a relationship between travel time to work and means of transportation and whether or not a woman has a physical disability. The methods completed so far have revealed the following answer to my initial research question: *some* means of transportation have a significant relationship with travel time to work; physical disability was not found to have a relationship at this time, per the Model 3 linear regression model. The following presents a discussion on the limitations of this study, which may contribute to why this is the answer to my research question at this point in time. 

### Transportation Costs

Transportation costs is a variable which I wish I was able to include from the beginning, but which was not available as a variable in the 1-year ACS from 2018. I think that looking at the transportation costs would strengthen the question of whether or not a system is equitable by comparing transportation costs with income.

### Race Variable

As previously mentioned, I had included race as a variable early on in creating my dataset. I initially wanted to understand if there was a relationship between race, a woman's means of transportation to work, and travel time to work. In pursuing the question of equity in NYC transportation infrastructures, I assumed race would be a necessary variable to include.

After completing the various tests and interpreting the results, I came to the conclusion that I need to include more variables when looking at race in order to answer a slightly different question. Looking at race on its own with respect to these other variables is not enough to reach a conclusion about equity. To address this additional question, altering this study to include a variable for neighborhood would be necessary in determining if there is even a correlation between race, where a woman lives, her access to transportation modes, and travel time to work.

### Disability Variables

For the sake of simplicity for the first assignment, I had only included ambulatory difficulty when looking at disability. In order to have a more well-rounded approach in determining whether or not a transportation system is equitable for disabled users, it is essential to include other disability variables, such as for vision, hearing, and cognitive disabilities. By including a wider range of disabilities, the conclusion of whether or not a transportation infrastructural system is equitable would be more in line with including everyone. It is not possible to talk about equity for all New Yorkers if entire groups of people are excluded.

### Sample

There are only 327 observations in my dataset. Had the sample size been larger, it may have been possible for other relationships to emerge. For example, there were only 13 observations in my sample who have a physical disability, compared to the remaining 314 observations who do not have a physical disability. Had the sample size been greater, I suspect there would have been more women who had a physical disability.

According to the CDC, about 1 in 4 women in the United States have a physical disability; the ratio of 13 women with a physical disability to 314 women without one does not accurately reflect this statistic. A consideration for why this may be the case is that the sample only includes women who are commuting to work, and who therefore have jobs. It is possible that there is an entire population of women with disabilities who do not have jobs. That means that this population is excluded from being counted in a sample which includes the variable "travel time to work". It is worth considering in a future study how other variables may be used as the dependent variable in order to fully capture the range of disabled women, whether they work or not.

### Gender Variable

In order to more accurately address the question "Is it equitable?", my analysis may benefit from making a comparison between women and men, with men being the reference value for a gender variable. The question I studied for this project was mainly concerned with women and whether or not they had a disability, but determining true equity requires including many other variables related to intersectional characteristics. 

## Conclusion

In New York City, about a quarter of the 472 subway stations are ADA accessible as of 2020 (an infographic depicting which stations are ADA accessible can be seen here: https://gothamist.com/news/infographic-how-much-nyc-subway-accessible). Poorly maintained bike lanes cause bumpy and uncomfortable rides for abled persons, yet they nearly eliminate the option of biking for some disabled people. Walking is a mode of transportation employed by many of the City's residents, but not all sidewalks are well-maintained, and there are instances of sidewalk obstructions which make it impossible for a person in a wheelchair or someone with a stroller to pass.

All of this is to say that New York City is comprised of a diverse population with many needs. It is the responsibility of the City to provide for the needs of everyday New Yorkers in a way that includes providing equal transportation service to everyone, regardless of gender, ability, age, race, socioeconomic status, and other self-identifying characteristics. It is necessary to look at this kind of data to determine whether or not the City's transportation infrastructure is equitable. Unequal service for people who live in the same city and are served by the same government agencies and officials is unjust.

People should care about this analysis and other similar analyses because the role of public transportation and transportation infrastructures maintained by government agencies (such as sidewalk and roadway conditions) is to serve the public. If there are members of the public who have a more difficult time using certain types of infrastructures, then this is important information for any transit agency or transportation planner to know in creating a more equitable transit experience. The goal of this project, and I hope in other future projects, is to help uncover instances of inequities which can be further investigated, and ultimately rectified.